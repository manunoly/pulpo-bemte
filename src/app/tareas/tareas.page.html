<app-header-bemte></app-header-bemte>

<ion-content>
    <app-header-user></app-header-user>

    <ion-grid padding>
        <form [formGroup]="tareaForm">
            <ion-row>
                <ion-col>
                    <ion-item lines="none">
                        <ion-label position="stacked">
                            <b>Materia</b>
                        </ion-label>
                        <ionic-selectable closeButtonText="Cerrar" class="ion-text-center borderRound"
                        [items]="materias" formControlName="materia" itemValueField="nombre" itemTextField="nombre"
                        [canSearch]="true">
                    </ionic-selectable>
                        <!-- <ion-select okText="Seleccionar" cancelText="Cancelar" class="ion-text-center"
                            [disabled]="!materias" formControlName="materia">
                            <ion-select-option *ngFor="let materia of materias | async" [value]="materia?.nombre">
                                {{materia?.nombre}}
                            </ion-select-option>
                        </ion-select> -->
                    </ion-item>

                    <ion-item>
                        <ion-label position="stacked">
                            <b>Tema</b>
                        </ion-label>
                        <ion-input formControlName="tema"> </ion-input>
                    </ion-item>

                    <ion-item>
                        <ion-label position="stacked"><b>Descripcion</b></ion-label>
                        <ion-textarea formControlName="descripcion"></ion-textarea>
                    </ion-item>

                    <ion-item lines="none">
                        <ion-label position="stacked"> <b>Fecha entrega</b></ion-label>
                        <ion-datetime doneText="Hecho" cancelText="Cancelar" class="ion-text-center" (ionChange)="validarHora($event?.detail?.value)"
                            [min]="fechaMinima" [max]="fechaMaxima" formControlName="fecha_entrega"
                            display-format="DD-MM-YYYY">
                        </ion-datetime>
                    </ion-item>

                    <ion-item lines="none">
                        <ion-label position="stacked"><b>Hora entrega</b></ion-label>
                        <ion-select okText="Seleccionar" cancelText="Cancelar" class="ion-text-center"
                            formControlName="hora_rango">
                            <ion-select-option *ngFor="let hora of rangosHorarios" [value]="hora">{{hora.hora_inicio}} -
                                {{hora.hora_fin}}</ion-select-option>
                        </ion-select>
                    </ion-item>

                    <ion-item lines="none">
                        <ion-label position="stacked"><b>Formato</b></ion-label>
                        <ion-select okText="Seleccionar" cancelText="Cancelar" class="ion-text-center"
                            formControlName="formato_entrega">
                            <ion-select-option value="word">Word</ion-select-option>
                            <ion-select-option value="pdf">PDF</ion-select-option>
                        </ion-select>
                    </ion-item>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col *ngIf="!img || img.length === 0; else imgData" size="6" offset="3">
                    <ion-button size="block" (click)="subir()">Adjuntar Imagen</ion-button>
                    <!-- <ion-button size="block" (click)="transferir()">Transferir</ion-button> -->
                </ion-col>
                <ng-template #imgData>
                    <ion-col size="10" offset="1">
                        <ion-item *ngFor="let imgD of img; index as pos" text-wrap>
                            <ion-thumbnail slot="start">
                                <ion-img [src]="imgD.path"></ion-img>
                            </ion-thumbnail>
                            <ion-label position="stacked">
                                <h5>{{ imgD.name }}</h5>
                            </ion-label>
                            <!-- <ion-button slot="end" fill="clear" (click)="upload.startUpload(imgD)">
                                <ion-icon slot="icon-only" name="cloud-upload"></ion-icon>
                            </ion-button> -->
                            <ion-button slot="end" fill="clear" (click)="upload.deleteImage(imgD, pos)">
                                <ion-icon slot="icon-only" color="danger" name="trash"></ion-icon>
                            </ion-button>
                        </ion-item>
                    </ion-col>
                </ng-template>
            </ion-row>
            <ion-row>
                <ion-col size="4" offset="1">
                    <ion-button color="tertiary" shape="round" (click)="atras()" size="block">Atras</ion-button>
                </ion-col>
                <ion-col size="4" offset="1">
                    <ion-button color="success" shape="round" [disabled]="!tareaForm.valid" (click)="confirmarTarea()"
                        size="block">Confirmar
                    </ion-button>
                </ion-col>
            </ion-row>
        </form>
    </ion-grid>
</ion-content>